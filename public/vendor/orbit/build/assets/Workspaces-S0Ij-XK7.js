import{d as P,Y as V,y as E,c as d,g as o,a as s,u as n,h as G,w as l,l as k,b as f,P as W,r as x,Z as T,F as y,i as D,t as p,U as O,M as F,f as b,_ as S,e as w,X as Y,o as a}from"./app-Dlk1-U9o.js";import{a as N}from"./axios-B1h-kVxr.js";import{_ as X}from"./Modal.vue_vue_type_script_setup_true_lang-ZqdZ-BJL.js";import{_ as Z}from"./EditorIcon.vue_vue_type_script_setup_true_lang-b3YiU64t.js";import{I as u}from"./craft-ui-D5hetQFK.js";import{L as j}from"./loader-circle-MU4xWfBI.js";import{T as q}from"./trash-2-xnYNepNO.js";const H={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between mb-8"},J={class:"flex items-center gap-2"},K={key:0,class:"rounded-lg border border-zinc-800 bg-zinc-900/50 p-12 text-center"},Q={key:1,class:"rounded-lg border border-zinc-800 bg-zinc-900/50 p-12 text-center"},R={key:2,class:"rounded-lg border border-zinc-800 bg-zinc-900/50 overflow-hidden"},ee={class:"flex items-center gap-3 min-w-0"},te={class:"flex h-8 w-8 items-center justify-center rounded-md bg-lime-500/15"},se={class:"flex items-center gap-3"},ne={class:"text-sm text-zinc-500"},ie={key:0,class:"flex -space-x-2"},oe=["title"],re={key:0,class:"flex h-7 w-7 items-center justify-center rounded-full bg-zinc-800 border-2 border-zinc-900 text-xs font-medium text-zinc-400"},ae={class:"flex items-center justify-end gap-2"},le={class:"flex items-center gap-0.5 opacity-60 hover:opacity-100 transition-opacity"},ce={class:"p-6"},de={class:"text-zinc-400 mb-6"},me={class:"flex justify-end gap-3"},ke=P({layout:V,__name:"Workspaces",props:{environment:{},editor:{},remoteApiUrl:{}},setup(m){const r=m,$=i=>r.remoteApiUrl?`${r.remoteApiUrl}${i}`:`/api/environments/${r.environment.id}${i}`,z=x([]),_=x(!0);async function C(){_.value=!0;try{const{data:i}=await N.get($("/workspaces"));i.success&&i.data?.workspaces&&(z.value=i.data.workspaces)}catch(i){if(O.isCancel(i))return;console.error("Failed to load workspaces:",i)}finally{_.value=!1}}E(()=>{C()});const g=x(null),v=x(!1),h=x(null),A=i=>{const t=`${i.path}/${i.name}.code-workspace`;let c;if(r.environment.external_access||!r.environment.is_local){const L=r.environment.user,M=r.environment.external_access&&r.environment.external_host?r.environment.external_host:r.environment.host;c=`${r.editor.scheme}://vscode-remote/ssh-remote+${L}@${M}${t}?windowId=_blank`}else c=`${r.editor.scheme}://file${t}`;window.open(c,"_blank")},U=i=>{const e=r.environment.user,t=r.environment.external_access&&r.environment.external_host?r.environment.external_host:r.environment.host,c=`ssh://${e}@${t}${i.path}`;window.open(c,"_self")},B=i=>{h.value=i,v.value=!0},I=async()=>{if(!h.value)return;const i=h.value;g.value=i,v.value=!1;try{const{data:e}=await N.delete($(`/workspaces/${i}`));e.success?(F.success(`Workspace "${i}" deleted successfully`),await C()):F.error("Failed to delete workspace",{description:e.error||"Unknown error"})}catch{}finally{g.value=null,h.value=null}};return(i,e)=>(a(),d(y,null,[o(n(G),{title:`Workspaces - ${m.environment.name}`},null,8,["title"]),s("div",null,[s("header",H,[e[3]||(e[3]=s("div",null,[s("h1",{class:"text-2xl font-semibold tracking-tight text-zinc-100"},"Workspaces"),s("p",{class:"text-sm text-zinc-500 mt-1"},"Group related sites together for easier management")],-1)),s("div",J,[o(n(u),{"as-child":"",size:"sm",class:"bg-lime-500 hover:bg-lime-600 text-zinc-950"},{default:l(()=>[o(n(k),{href:`/environments/${m.environment.id}/workspaces/create`},{default:l(()=>[o(n(W),{class:"w-4 h-4 mr-1.5"}),e[2]||(e[2]=f(" New Workspace ",-1))]),_:1},8,["href"])]),_:1})])]),_.value?(a(),d("div",K,[o(n(j),{class:"w-8 h-8 mx-auto text-zinc-600 animate-spin mb-4"}),e[4]||(e[4]=s("p",{class:"text-zinc-500"},"Loading workspaces...",-1))])):z.value.length===0?(a(),d("div",Q,[o(n(T),{class:"w-12 h-12 mx-auto text-zinc-600 mb-4"}),e[6]||(e[6]=s("h3",{class:"text-lg font-medium text-zinc-100 mb-2"},"No workspaces yet",-1)),e[7]||(e[7]=s("p",{class:"text-zinc-400 mb-6"},"Create a workspace to group related sites together.",-1)),o(n(u),{"as-child":"",size:"sm",class:"bg-lime-500 hover:bg-lime-600 text-zinc-950"},{default:l(()=>[o(n(k),{href:`/environments/${m.environment.id}/workspaces/create`},{default:l(()=>[o(n(W),{class:"w-4 h-4 mr-1.5"}),e[5]||(e[5]=f(" Create Your First Workspace ",-1))]),_:1},8,["href"])]),_:1})])):(a(),d("div",R,[e[9]||(e[9]=s("div",{class:"grid grid-cols-[1fr_1fr_140px] items-center gap-4 px-4 py-3 border-b border-zinc-800 bg-zinc-800/30"},[s("span",{class:"text-xs font-medium text-zinc-500 uppercase tracking-wide"},"Workspace"),s("span",{class:"text-xs font-medium text-zinc-500 uppercase tracking-wide"},"Sites"),s("span",{class:"text-xs font-medium text-zinc-500 uppercase tracking-wide text-right"},"Actions")],-1)),s("div",null,[(a(!0),d(y,null,D(z.value,t=>(a(),d("div",{key:t.name,class:"grid grid-cols-[1fr_1fr_140px] items-center gap-4 px-4 py-4 border-b border-zinc-800/50 last:border-b-0 transition-colors hover:bg-zinc-800/30"},[s("div",ee,[s("div",te,[o(n(T),{class:"h-4 w-4 text-lime-400"})]),o(n(k),{href:`/environments/${m.environment.id}/workspaces/${t.name}`,class:"font-medium text-sm text-zinc-100 hover:text-lime-400 transition-colors"},{default:l(()=>[f(p(t.name),1)]),_:2},1032,["href"])]),s("div",se,[s("span",ne,p(t.site_count)+" site"+p(t.site_count!==1?"s":""),1),t.sites.length>0?(a(),d("div",ie,[(a(!0),d(y,null,D(t.sites.slice(0,3),c=>(a(),d("div",{key:c.name,class:"flex h-7 w-7 items-center justify-center rounded-full bg-zinc-800 border-2 border-zinc-900 text-xs",title:c.name},[o(n(S),{class:"h-3 w-3 text-zinc-400"})],8,oe))),128)),t.sites.length>3?(a(),d("div",re," +"+p(t.sites.length-3),1)):b("",!0)])):b("",!0)]),s("div",ae,[o(n(u),{"as-child":"",variant:"outline",size:"sm",class:"h-8 px-3 bg-transparent border-zinc-700 text-zinc-300 hover:bg-zinc-800"},{default:l(()=>[o(n(k),{href:`/environments/${m.environment.id}/workspaces/${t.name}`},{default:l(()=>[...e[8]||(e[8]=[f(" Manage ",-1)])]),_:1},8,["href"])]),_:2},1024),s("div",le,[m.environment.external_access?(a(),w(n(u),{key:0,onClick:c=>U(t),variant:"ghost",size:"icon-sm",class:"h-8 w-8 text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800",title:"Open in Terminal"},{default:l(()=>[o(n(Y),{class:"w-3.5 h-3.5"})]),_:1},8,["onClick"])):b("",!0),t.has_workspace_file?(a(),w(n(u),{key:1,onClick:c=>A(t),variant:"ghost",size:"icon-sm",class:"h-8 w-8 text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800",title:`Open in ${m.editor.name}`},{default:l(()=>[o(Z,{editor:m.editor.scheme,class:"w-3.5 h-3.5"},null,8,["editor"])]),_:1},8,["onClick","title"])):b("",!0),o(n(u),{onClick:c=>B(t.name),variant:"ghost",size:"icon-sm",class:"h-8 w-8 text-zinc-400 hover:text-red-400 hover:bg-red-500/10",disabled:g.value===t.name,title:"Delete workspace"},{default:l(()=>[g.value===t.name?(a(),w(n(j),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(a(),w(n(q),{key:1,class:"w-3.5 h-3.5"}))]),_:2},1032,["onClick","disabled"])])])]))),128))])]))]),o(X,{show:v.value,title:"Delete Workspace",onClose:e[1]||(e[1]=t=>v.value=!1)},{default:l(()=>[s("div",ce,[s("p",de,' Are you sure you want to delete the workspace "'+p(h.value)+`"? This will remove the workspace directory and symlinks, but won't delete the actual sites. `,1),s("div",me,[o(n(u),{onClick:e[0]||(e[0]=t=>v.value=!1),variant:"ghost"},{default:l(()=>[...e[10]||(e[10]=[f("Cancel",-1)])]),_:1}),o(n(u),{onClick:I,variant:"destructive"},{default:l(()=>[...e[11]||(e[11]=[f(" Delete Workspace ",-1)])]),_:1})])])]),_:1},8,["show"])],64))}});export{ke as default};
