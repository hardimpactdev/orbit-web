import{d as M,Z as V,m as E,a as d,h as r,b as s,u as n,i as G,w as l,l as k,e as f,P as C,r as x,_ as W,F as y,j as T,t as h,M as O,x as D,g as b,$ as S,f as w,T as Y,o as a}from"./app-CNm8s883.js";import{a as F}from"./axios-CJf2Eu_M.js";import{_ as Z}from"./Modal.vue_vue_type_script_setup_true_lang-Bd29e0pB.js";import{_ as q}from"./EditorIcon.vue_vue_type_script_setup_true_lang-ChKW2Uxo.js";import{I as u}from"./craft-ui-Bs8mf6IE.js";import{L as N}from"./loader-circle-CHmhc5nJ.js";import{T as H}from"./trash-2-DqE5YB6K.js";const J={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between mb-8"},K={class:"flex items-center gap-2"},Q={key:0,class:"rounded-lg border border-zinc-800 bg-zinc-900/50 p-12 text-center"},R={key:1,class:"rounded-lg border border-zinc-800 bg-zinc-900/50 p-12 text-center"},X={key:2,class:"rounded-lg border border-zinc-800 bg-zinc-900/50 overflow-hidden"},ee={class:"flex items-center gap-3 min-w-0"},te={class:"flex h-8 w-8 items-center justify-center rounded-md bg-lime-500/15"},se={class:"flex items-center gap-3"},ne={class:"text-sm text-zinc-500"},oe={key:0,class:"flex -space-x-2"},re=["title"],ie={key:0,class:"flex h-7 w-7 items-center justify-center rounded-full bg-zinc-800 border-2 border-zinc-900 text-xs font-medium text-zinc-400"},ae={class:"flex items-center justify-end gap-2"},le={class:"flex items-center gap-0.5 opacity-60 hover:opacity-100 transition-opacity"},ce={class:"p-6"},de={class:"text-zinc-400 mb-6"},me={class:"flex justify-end gap-3"},ke=M({layout:V,__name:"Workspaces",props:{environment:{},editor:{},remoteApiUrl:{}},setup(m){const i=m,$=o=>i.remoteApiUrl?`${i.remoteApiUrl}${o}`:`/api/environments/${i.environment.id}${o}`,z=x([]),_=x(!0);async function j(){_.value=!0;try{const{data:o}=await F.get($("/workspaces"));o.success&&o.data?.workspaces&&(z.value=o.data.workspaces)}catch(o){if(O.isCancel(o))return;console.error("Failed to load workspaces:",o)}finally{_.value=!1}}E(()=>{j()});const g=x(null),v=x(!1),p=x(null),A=o=>{const t=`${o.path}/${o.name}.code-workspace`;let c;if(i.environment.external_access||!i.environment.is_local){const P=i.environment.user,U=i.environment.external_access&&i.environment.external_host?i.environment.external_host:i.environment.host;c=`${i.editor.scheme}://vscode-remote/ssh-remote+${P}@${U}${t}?windowId=_blank`}else c=`${i.editor.scheme}://file${t}`;window.open(c,"_blank")},B=o=>{const e=i.environment.user,t=i.environment.external_access&&i.environment.external_host?i.environment.external_host:i.environment.host,c=`ssh://${e}@${t}${o.path}`;window.open(c,"_self")},I=o=>{p.value=o,v.value=!0},L=async()=>{if(!p.value)return;const o=p.value;g.value=o,v.value=!1;try{const{data:e}=await F.delete($(`/workspaces/${o}`));e.success?(D.success(`Workspace "${o}" deleted successfully`),await j()):D.error("Failed to delete workspace",{description:e.error||"Unknown error"})}catch{}finally{g.value=null,p.value=null}};return(o,e)=>(a(),d(y,null,[r(n(G),{title:`Workspaces - ${m.environment.name}`},null,8,["title"]),s("div",null,[s("header",J,[e[3]||(e[3]=s("div",null,[s("h1",{class:"text-2xl font-semibold tracking-tight text-zinc-100"},"Workspaces"),s("p",{class:"text-sm text-zinc-500 mt-1"},"Group related projects together for easier management")],-1)),s("div",K,[r(n(u),{"as-child":"",size:"sm",class:"bg-lime-500 hover:bg-lime-600 text-zinc-950"},{default:l(()=>[r(n(k),{href:`/environments/${m.environment.id}/workspaces/create`},{default:l(()=>[r(n(C),{class:"w-4 h-4 mr-1.5"}),e[2]||(e[2]=f(" New Workspace ",-1))]),_:1},8,["href"])]),_:1})])]),_.value?(a(),d("div",Q,[r(n(N),{class:"w-8 h-8 mx-auto text-zinc-600 animate-spin mb-4"}),e[4]||(e[4]=s("p",{class:"text-zinc-500"},"Loading workspaces...",-1))])):z.value.length===0?(a(),d("div",R,[r(n(W),{class:"w-12 h-12 mx-auto text-zinc-600 mb-4"}),e[6]||(e[6]=s("h3",{class:"text-lg font-medium text-zinc-100 mb-2"},"No workspaces yet",-1)),e[7]||(e[7]=s("p",{class:"text-zinc-400 mb-6"},"Create a workspace to group related projects together.",-1)),r(n(u),{"as-child":"",size:"sm",class:"bg-lime-500 hover:bg-lime-600 text-zinc-950"},{default:l(()=>[r(n(k),{href:`/environments/${m.environment.id}/workspaces/create`},{default:l(()=>[r(n(C),{class:"w-4 h-4 mr-1.5"}),e[5]||(e[5]=f(" Create Your First Workspace ",-1))]),_:1},8,["href"])]),_:1})])):(a(),d("div",X,[e[9]||(e[9]=s("div",{class:"grid grid-cols-[1fr_1fr_140px] items-center gap-4 px-4 py-3 border-b border-zinc-800 bg-zinc-800/30"},[s("span",{class:"text-xs font-medium text-zinc-500 uppercase tracking-wide"},"Workspace"),s("span",{class:"text-xs font-medium text-zinc-500 uppercase tracking-wide"},"Projects"),s("span",{class:"text-xs font-medium text-zinc-500 uppercase tracking-wide text-right"},"Actions")],-1)),s("div",null,[(a(!0),d(y,null,T(z.value,t=>(a(),d("div",{key:t.name,class:"grid grid-cols-[1fr_1fr_140px] items-center gap-4 px-4 py-4 border-b border-zinc-800/50 last:border-b-0 transition-colors hover:bg-zinc-800/30"},[s("div",ee,[s("div",te,[r(n(W),{class:"h-4 w-4 text-lime-400"})]),r(n(k),{href:`/environments/${m.environment.id}/workspaces/${t.name}`,class:"font-medium text-sm text-zinc-100 hover:text-lime-400 transition-colors"},{default:l(()=>[f(h(t.name),1)]),_:2},1032,["href"])]),s("div",se,[s("span",ne,h(t.project_count)+" project"+h(t.project_count!==1?"s":""),1),t.projects.length>0?(a(),d("div",oe,[(a(!0),d(y,null,T(t.projects.slice(0,3),c=>(a(),d("div",{key:c.name,class:"flex h-7 w-7 items-center justify-center rounded-full bg-zinc-800 border-2 border-zinc-900 text-xs",title:c.name},[r(n(S),{class:"h-3 w-3 text-zinc-400"})],8,re))),128)),t.projects.length>3?(a(),d("div",ie," +"+h(t.projects.length-3),1)):b("",!0)])):b("",!0)]),s("div",ae,[r(n(u),{"as-child":"",variant:"outline",size:"sm",class:"h-8 px-3 bg-transparent border-zinc-700 text-zinc-300 hover:bg-zinc-800"},{default:l(()=>[r(n(k),{href:`/environments/${m.environment.id}/workspaces/${t.name}`},{default:l(()=>[...e[8]||(e[8]=[f(" Manage ",-1)])]),_:1},8,["href"])]),_:2},1024),s("div",le,[m.environment.external_access?(a(),w(n(u),{key:0,onClick:c=>B(t),variant:"ghost",size:"icon-sm",class:"h-8 w-8 text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800",title:"Open in Terminal"},{default:l(()=>[r(n(Y),{class:"w-3.5 h-3.5"})]),_:1},8,["onClick"])):b("",!0),t.has_workspace_file?(a(),w(n(u),{key:1,onClick:c=>A(t),variant:"ghost",size:"icon-sm",class:"h-8 w-8 text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800",title:`Open in ${m.editor.name}`},{default:l(()=>[r(q,{editor:m.editor.scheme,class:"w-3.5 h-3.5"},null,8,["editor"])]),_:1},8,["onClick","title"])):b("",!0),r(n(u),{onClick:c=>I(t.name),variant:"ghost",size:"icon-sm",class:"h-8 w-8 text-zinc-400 hover:text-red-400 hover:bg-red-500/10",disabled:g.value===t.name,title:"Delete workspace"},{default:l(()=>[g.value===t.name?(a(),w(n(N),{key:0,class:"w-3.5 h-3.5 animate-spin"})):(a(),w(n(H),{key:1,class:"w-3.5 h-3.5"}))]),_:2},1032,["onClick","disabled"])])])]))),128))])]))]),r(Z,{show:v.value,title:"Delete Workspace",onClose:e[1]||(e[1]=t=>v.value=!1)},{default:l(()=>[s("div",ce,[s("p",de,' Are you sure you want to delete the workspace "'+h(p.value)+`"? This will remove the workspace directory and symlinks, but won't delete the actual projects. `,1),s("div",me,[r(n(u),{onClick:e[0]||(e[0]=t=>v.value=!1),variant:"ghost"},{default:l(()=>[...e[10]||(e[10]=[f("Cancel",-1)])]),_:1}),r(n(u),{onClick:L,variant:"destructive"},{default:l(()=>[...e[11]||(e[11]=[f(" Delete Workspace ",-1)])]),_:1})])])]),_:1},8,["show"])],64))}});export{ke as default};
